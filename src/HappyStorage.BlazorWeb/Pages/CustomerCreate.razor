@page "/customer/create";
@using HappyStorage.Common.Ui.Customers;
@using HappyStorage.BlazorWeb.Components;
@inject Microsoft.AspNetCore.Components.IUriHelper UriHelper
@inject HappyStorage.Common.Ui.Customers.ICustomerCreateViewModel viewModel;

<h1>Create Customer</h1>

<EditForm Model="@newCustomer" OnValidSubmit="@HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />
    <div class="form-group">
        <h3>Name</h3>
        <LabelComponent viewModel="@newCustomer" property="@nameof(newCustomer.FirstName)"/>
        <input class="form-control" bind="@newCustomer.FirstName" type="text" placeholder="First Name" />

        <LabelComponent viewModel="@newCustomer" property="@nameof(newCustomer.LastName)" />
        <input class="form-control" bind="@newCustomer.LastName" type="text" placeholder="First Name" />
    </div>
    <div class="form-group">
        <h3>Address</h3>

        <LabelComponent viewModel="@newCustomer" property="@nameof(newCustomer.Street)" />
        <input class="form-control" bind="@newCustomer.Street" type="text" placeholder="1 Copley Parkway" />

        <LabelComponent viewModel="@newCustomer" property="@nameof(newCustomer.City)" />
        <input class="form-control" bind="@newCustomer.City" type="text" placeholder="Morrisville" />

        <LabelComponent viewModel="@newCustomer" property="@nameof(newCustomer.State)" />
        <input class="form-control" bind="@newCustomer.State" type="text" placeholder="NC" />

        <LabelComponent viewModel="@newCustomer" property="@nameof(newCustomer.PostalCode)" />
        <input class="form-control" bind="@newCustomer.PostalCode" type="number" placeholder="27560" />
    </div>
    <br />
    <button class="btn btn-primary" type="submit">Submit</button>
    <button class="btn">Cancel</button>

    <button type="submit">Submit</button>
</EditForm>

@functions {

    private NewCustomerModel newCustomer = new NewCustomerModel();

    private void HandleValidSubmit()
    {
        viewModel.Create(newCustomer);
        UriHelper.NavigateTo("/customers");
    }
}